<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Cats API demo</title>
    <style>
        body{font-family:Arial,Helvetica,sans-serif;margin:2rem;}
        fieldset{margin-bottom:1.5rem;padding:1rem;}
        input,textarea,button{margin:0.25rem 0;}
        pre{background:#f5f5f5;padding:1rem;white-space:pre-wrap;}
    </style>
</head>
<body>
<h1>–†–∞–±–æ—Ç–∞–µ–º —Å –∫–æ—Ç–∞–º–∏ üê±</h1>

<a href="owners.html">‚§¥ –ü–µ—Ä–µ–π—Ç–∏ –∫ –≤–ª–∞–¥–µ–ª—å—Ü–∞–º</a>

<fieldset>
    <legend>–°–æ–∑–¥–∞—Ç—å –∫–æ—Ç–∞ (POST¬†/‚Äãcats)</legend>
    <label>JSON —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞:<br>
        <textarea id="catJson" rows="5" cols="60">
{
  "name":"–ë–∞—Ä—Å–∏–∫",
  "color":"BLACK",
  "breed":"MAINE_COON",
  "birthDate":"2020-05-19"
}
        </textarea>
    </label><br>
    <button onclick="createCat()">–°–æ–∑–¥–∞—Ç—å</button>
</fieldset>

<fieldset>
    <legend>–ü–æ–ª—É—á–∏—Ç—å –∫–æ—Ç–∞ –ø–æ¬†ID (GET¬†/‚Äãcats/{id})</legend>
    <input id="getCatId" type="number" placeholder="ID">
    <button onclick="getCat()">–ü–æ–ª—É—á–∏—Ç—å</button>
</fieldset>

<fieldset>
    <legend>–°–ø–∏—Å–æ–∫ –∫–æ—Ç–æ–≤ (GET¬†/‚Äãcats/getAll)</legend>
    <label>offset <input id="offset" type="number" value="0" style="width:4rem"></label>
    <label>limit  <input id="limit"  type="number" value="20" style="width:4rem"></label>
    <button onclick="getAllCats()">–ü–æ–∫–∞–∑–∞—Ç—å</button>
</fieldset>

<fieldset>
    <legend>–£–¥–∞–ª–µ–Ω–∏–µ</legend>
    <label>–£–¥–∞–ª–∏—Ç—å –∫–æ—Ç–∞ –ø–æ¬†ID (DELETE¬†/‚Äãcats/{id})¬†
        <input id="delCatId" type="number" placeholder="ID">
        <button onclick="deleteCat()">–£–¥–∞–ª–∏—Ç—å</button>
    </label><br>
    <button onclick="deleteAllCats()" style="margin-top:0.75rem">–£–¥–∞–ª–∏—Ç—å –í–°–ï–• (DELETE¬†/‚Äãcats)</button>
</fieldset>

<fieldset>
    <legend>–î–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∞ (POST¬†/‚Äãcats/{catId}/friends/{friendId})</legend>
    <input id="catId"     type="number" placeholder="catId">
    <input id="friendId"  type="number" placeholder="friendId">
    <button onclick="addFriend()">–î–æ–±–∞–≤–∏—Ç—å</button>
</fieldset>

<fieldset>
    <legend>–û–±–Ω–æ–≤–∏—Ç—å –∫–æ—Ç–∞ (PUT¬†/‚Äãcats/{id})</legend>
    <input id="updCatId" type="number" placeholder="ID"><br>
    <textarea id="updCatJson" rows="4" cols="60">
{
  "name":"–ë–∞—Ä—Å–∏–∫‚Äë—Å—Ç–∞—Ä—à–∏–π",
  "color":"WHITE"
}
    </textarea><br>
    <button onclick="updateCat()">–û–±–Ω–æ–≤–∏—Ç—å</button>
</fieldset>

<h2>–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞</h2>
<pre id="out">¬†</pre>

<script>
    const out = document.getElementById('out');

    function show(r){out.textContent=typeof r==='string'?r:JSON.stringify(r,null,2);}

    async function createCat(){
        const body=document.getElementById('catJson').value;
        const res=await fetch('/cats',{method:'POST',headers:{'Content-Type':'application/json'},body});
        show(await res.json());
    }
    async function getCat(){
        const id=document.getElementById('getCatId').value;
        const res=await fetch(`/cats/${id}`);
        show(await res.json());
    }
    async function getAllCats(){
        const off=document.getElementById('offset').value||0;
        const lim=document.getElementById('limit').value||20;
        const res=await fetch(`/cats/getAll?offset=${off}&limit=${lim}`);
        show(await res.json());
    }
    async function deleteCat(){
        const id=document.getElementById('delCatId').value;
        const res=await fetch(`/cats/${id}`,{method:'DELETE'});
        show(res.ok?`–ö–æ—Ç ${id} —É–¥–∞–ª—ë–Ω`:'–û—à–∏–±–∫–∞');
    }
    async function deleteAllCats(){
        const res=await fetch('/cats',{method:'DELETE'});
        show(res.ok?'–í—Å–µ –∫–æ—Ç—ã —É–¥–∞–ª–µ–Ω—ã':'–û—à–∏–±–∫–∞');
    }
    async function addFriend(){
        const catId=document.getElementById('catId').value;
        const friendId=document.getElementById('friendId').value;
        const res=await fetch(`/cats/${catId}/friends/${friendId}`,{method:'POST'});
        show(res.ok?'–î—Ä—É–≥ –¥–æ–±–∞–≤–ª–µ–Ω':'–û—à–∏–±–∫–∞');
    }
    async function updateCat(){
        const id=document.getElementById('updCatId').value;
        const body=document.getElementById('updCatJson').value;
        const res=await fetch(`/cats/${id}`,{method:'PUT',headers:{'Content-Type':'application/json'},body});
        show(await res.json());
    }
</script>
</body>
</html>