<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Cat‚ÄëOwners API demo</title>
    <style>
        body{font-family:Arial,Helvetica,sans-serif;margin:2rem;}
        fieldset{margin-bottom:1.5rem;padding:1rem;}
        input,textarea,button{margin:0.25rem 0;}
        pre{background:#f5f5f5;padding:1rem;white-space:pre-wrap;}
    </style>
</head>
<body>
<h1>–†–∞–±–æ—Ç–∞–µ–º —Å –≤–ª–∞–¥–µ–ª—å—Ü–∞–º–∏ üßë‚Äçüíº</h1>

<a href="cats.html">‚§¥ –ü–µ—Ä–µ–π—Ç–∏ –∫ –∫–æ—Ç–∞–º</a>

<fieldset>
    <legend>–°–æ–∑–¥–∞—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ (POST¬†/‚Äãowners)</legend>
    <textarea id="ownerJson" rows="5" cols="60">
{
  "name":"–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "birthDate":"1990-02-14"
}
    </textarea><br>
    <button onclick="createOwner()">–°–æ–∑–¥–∞—Ç—å</button>
</fieldset>

<fieldset>
    <legend>–ü–æ–ª—É—á–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ –ø–æ¬†ID (GET¬†/‚Äãowners/{id})</legend>
    <input id="getOwnerId" type="number" placeholder="ID">
    <button onclick="getOwner()">–ü–æ–ª—É—á–∏—Ç—å</button>
</fieldset>

<fieldset>
    <legend>–°–ø–∏—Å–æ–∫ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ (GET¬†/‚Äãowners/getAll)</legend>
    <label>offset <input id="oOffset" type="number" value="0" style="width:4rem"></label>
    <label>limit  <input id="oLimit"  type="number" value="20" style="width:4rem"></label>
    <button onclick="getAllOwners()">–ü–æ–∫–∞–∑–∞—Ç—å</button>
</fieldset>

<fieldset>
    <legend>–£–¥–∞–ª–µ–Ω–∏–µ</legend>
    <label>–£–¥–∞–ª–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ –ø–æ¬†ID (DELETE¬†/‚Äãowners/{id})¬†
        <input id="delOwnerId" type="number" placeholder="ID">
        <button onclick="deleteOwner()">–£–¥–∞–ª–∏—Ç—å</button>
    </label><br>
    <button onclick="deleteAllOwners()" style="margin-top:0.75rem">–£–¥–∞–ª–∏—Ç—å –í–°–ï–• (DELETE¬†/‚Äãowners)</button>
</fieldset>

<fieldset>
    <legend>–î–æ–±–∞–≤–∏—Ç—å –∫–æ—Ç–∞ –≤–ª–∞–¥–µ–ª—å—Ü—É (POST¬†/‚Äãowners/{ownerId}/cats/{catId})</legend>
    <input id="ownerId" type="number" placeholder="ownerId">
    <input id="catId2"  type="number" placeholder="catId">
    <button onclick="addCatToOwner()">–î–æ–±–∞–≤–∏—Ç—å</button>
</fieldset>

<fieldset>
    <legend>–û–±–Ω–æ–≤–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ (PUT¬†/‚Äãowners/{id})</legend>
    <input id="updOwnerId" type="number" placeholder="ID"><br>
    <textarea id="updOwnerJson" rows="4" cols="60">
{
  "name":"–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"
}
    </textarea><br>
    <button onclick="updateOwner()">–û–±–Ω–æ–≤–∏—Ç—å</button>
</fieldset>


<h2>–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞</h2>
<pre id="out">¬†</pre>

<script>
    const out=document.getElementById('out');
    function show(r){out.textContent=typeof r==='string'?r:JSON.stringify(r,null,2);}

    async function createOwner(){
        const body=document.getElementById('ownerJson').value;
        const res=await fetch('/owners',{method:'POST',headers:{'Content-Type':'application/json'},body});
        show(await res.json());
    }
    async function getOwner(){
        const id=document.getElementById('getOwnerId').value;
        const res=await fetch(`/owners/${id}`);
        show(await res.json());
    }
    async function getAllOwners(){
        const off=document.getElementById('oOffset').value||0;
        const lim=document.getElementById('oLimit').value||20;
        const res=await fetch(`/owners/getAll?offset=${off}&limit=${lim}`);
        show(await res.json());
    }
    async function deleteOwner(){
        const id=document.getElementById('delOwnerId').value;
        const res=await fetch(`/owners/${id}`,{method:'DELETE'});
        show(res.ok?`–í–ª–∞–¥–µ–ª–µ—Ü ${id} —É–¥–∞–ª—ë–Ω`:'–û—à–∏–±–∫–∞');
    }
    async function deleteAllOwners(){
        const res=await fetch('/owners',{method:'DELETE'});
        show(res.ok?'–í—Å–µ –≤–ª–∞–¥–µ–ª—å—Ü—ã —É–¥–∞–ª–µ–Ω—ã':'–û—à–∏–±–∫–∞');
    }
    async function addCatToOwner(){
        const ownerId=document.getElementById('ownerId').value;
        const catId=document.getElementById('catId2').value;
        const res=await fetch(`/owners/${ownerId}/cats/${catId}`,{method:'POST'});
        show(res.ok?'–ö–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤–ª–∞–¥–µ–ª—å—Ü—É':'–û—à–∏–±–∫–∞');
    }
    async function updateOwner(){
        const id=document.getElementById('updOwnerId').value;
        const body=document.getElementById('updOwnerJson').value;
        const res=await fetch(`/owners/${id}`,{method:'PUT',headers:{'Content-Type':'application/json'},body});
        show(await res.json());
    }
</script>
</body>
</html>